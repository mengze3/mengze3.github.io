---
title: "Fixed
-
Wing Long
-
Range Covert Flight Optimization in Collaboration between DJI and FastLab"
permalink: /fixed_wing/
author_profile: true
redirect_from:
  - /resume
---

{% include base_path %}

<head>
    <style>
        .container {
            display: flex; /* Use Flexbox for layout */
            align-items: start; /* Align items at the start of the container */
        }
        .video {
            width: 50%; /* Assign 50% width for the video */
            padding-right: 10px; /* Add some space between video and text */
        }
        .text {
            width: 50%; /* Assign 50% width for the text */
        }
      .center {
            text-align: center;
        }
        iframe {
            width: 100%; /* Make the video responsive */
            height: 300px; /* Set a fixed height for the video */
        }
        .flex-container {
            display: flex;
        }
    </style>
</head>


<body>


    <h1>Neural Path Planning</h1>
    <div class="center">
      <img  width="840" height="540" src="https://github.com/mengze3/mengze3.github.io/blob/421c4b5c5f81165712a7c560a546eac8570d416b/_pages/model2.png?raw=true" alt="">
  </div>
    <p>A neural network path planner was proposed to learn data for trajectory optimization. It reads information from maps and poses. The structure is divided into three layers: 
      feature extraction layer, global distribution layer, and local correction layer. The feature extraction layer is used to extract information from maps and poses; 
      the global distribution layer aims to locate the general area of the path; the local correction layer focuses on finding the precise locations of these path points in the area. 
      This approach has three advantages. First, because it is a neural network, its inference speed is relatively stable. Second, the neural network size can be made very small, enhancing its efficiency. 
      Third, since it learns data from backend trajectory optimization, it takes into account the process of backend trajectory optimization, 
      providing a better initial value for the backend. I have applied this method on Ackerman vehicles and achieved certain results.</p>



  
    <h1>Fixed-Wing Long-Range Covert Flight </h1>
  <p>The generation of global trajectories for fixed-wing aircraft follows a hierarchical framework. Initially, a sampling-based dynamic path planning algorithm is used, 
    targeting exploration within the global environment to find a better path topology. The paths generated in this step are not smooth and may not be entirely dynamically feasible. 
    To address this issue, a numerical optimization-based algorithm is employed to further optimize the output of the previous step in the continuous state space. 
    This ensures stealth in flight while effectively improving the smoothness and dynamic feasibility of the trajectory. 
    Due to the order of magnitude difference in the map size and the altitude range of the aircraft, the trajectory planning problem is modeled as a two-dimensional trajectory generation problem. 
    Here, the aircraft is set to maintain a constant altitude of 60 meters, 
    with a flight speed of 150 meters per second. Mountainous terrains on the map exceeding 60 meters in height are treated as impassable obstacles.</p>
    
   <h2>Sampling-Based Global Covert Rough Path Planning</h2>
  <div class="center">
      <img  width="480" height="360" src="https://github.com/mengze3/mengze3.github.io/blob/96a2010660a9e880b3ac05d6ee48315dbfe4d0c5/_pages/rrt.png?raw=true" alt="">
  </div>
    <p>In the application of this project, it is necessary to specially design the loss function. To ensure covert flight, 
      the loss function needs to be specifically designed based on the level of concealment provided by the environment, making covert paths more likely to be selected and integrated into the optimal trajectory.
      To achieve this effect, the project proposes to first conduct terrain estimation. During sampling, the terrain difference will be integrated along the trajectory between sampled state points to assess the level of concealment of the terrain. 
      Here, the terrain difference will be defined as the elevation difference within a prescribed square area centered on the state points.</p>

    <div class="center">
      <img  width="200" height="150"src="https://github.com/mengze3/mengze3.github.io/blob/c78ae6bc22e32ff20df7cb4e361a9175cdabb338/_pages/terrain_1.png?raw=true" alt="">
    </div>


  <p>For any straight line connecting two nodes, the loss function for that line segment is defined as follows:</p>


  <div class="center">
    <img  src="https://github.com/mengze3/mengze3.github.io/blob/c78ae6bc22e32ff20df7cb4e361a9175cdabb338/_pages/terrain_2.png?raw=true" alt="">
  </div>


  <p>In the equation, w represents the weight that measures the importance of concealment, and p(s) denotes the coordinates of a point on the straight line. 
    It can be observed that when the weight w is set to 0, the loss function reduces to the length of the line segment. 
    However, when the weight is non-zero, the greater the difference in terrain, the smaller the loss value for that point.</p>


   <h2>Gradient-Based Efficient Trajectory Optimization</h2>
    <p>In reality, due to limitations in sampling resolution and the number of samples, the trajectory obtained in the previous section is relatively coarse. 
      Some segments of the trajectory may not be kinematically feasible and may even pose a collision risk. Therefore, in this section, 
      we aim to improve the smoothness and feasibility of the trajectory by using the previous path as an initial guess and applying optimization-based methods to deform the path in continuous space.
    In this chapter, we parameterize the trajectory using piecewise polynomials, denoted as p(s). Each segment of the trajectory is represented by pi(s), 
    where i refers to the i-th segment. In this project, the optimization formulation for trajectory planning is as follows:</p>

  <div class="center">
    <img  src="https://github.com/mengze3/mengze3.github.io/blob/c78ae6bc22e32ff20df7cb4e361a9175cdabb338/_pages/terrain_2.png?raw=true" alt="">
  </div>

  <p>In the formulation, d represents the dimension of the control variable, and the integral term has the physical interpretation of minimizing energy to improve trajectory smoothness. 
    In the implementation details, d is set to 3, which means minimizing the jerk (rate of change of acceleration) of the trajectory. 
    f denotes the concealment function, which aims to guide the trajectory towards areas with higher concealment. 
    Gcos is the obstacle avoidance function, which aims to keep the trajectory away from restricted areas such as mountains by constructing an Euclidean signed distance field. 
    Intuitively, we can estimate the distance value and gradient at each point to push the entire trajectory away from restricted areas. 
    kmax represents the maximum curvature of the trajectory to ensure nonholonomic dynamics.
    To ensure continuity throughout the motion, high-order continuity is required at the connection points between adjacent polynomials. 
    This continuity is denoted as D. To eliminate the equality constraints in the optimization formulation, this project uses the MINCO trajectory class to replace traditional piecewise polynomials without any special features. 
    The advantage of this trajectory class is that it can transform the parameter space of piecewise polynomials from polynomial coefficients and time to path points and "time" while satisfying the condition of minimum energy. 
    The transformation is illustrated in the figure below:</p>


  <div class="center">
    <img  src="https://github.com/mengze3/mengze3.github.io/blob/fb27cd3045091bd28d09e42ff86885a3bf5f687e/_pages/terrain_4.png?raw=true" alt="">
  </div>
    


     <h2>Simulation Verification</h2>
  <div class="center">
      <img  width="480" height="360" src="https://github.com/mengze3/mengze3.github.io/blob/fb27cd3045091bd28d09e42ff86885a3bf5f687e/_pages/terrain_3.png?raw=true" alt="">
  </div>
    <p>The aim here is to ensure that the drone maintains a line of sight to the target during the tracking mission.
    A key contribution of this subsection is the development of a sector-shaped visible region for each predicted position of the target.
    This visible region is designed to account for potential occlusions and to guide the drone in maintaining an optimal position for visibility. 
    It is a crucial part of the system, ensuring that the target remains within the drone's field of view throughout the tracking process.</p>


    <h1>Learning-Aided Fixed-Wing Long-Range Covert Flight Optimization </h1>
  
    <img src="https://github.com/mengze3/mengze3.github.io/blob/85ed4283c001b95214b7627a670d0f036b9bd630/_pages/old_detect.png?raw=true" alt="original detection">
    <p>  A formidable obstacle surfaced: the low accuracy of image recognition, attributed to inadequate data stemming from the diverse scenes encountered during UAV flights.</p>

      <div class="center">
        <img  width="480" height="360" src="https://github.com/mengze3/mengze3.github.io/blob/4b73183ed170615e62c442be03e2334af1856149/_pages/flur1.jpg?raw=true" alt="">
    </div>
    <p>    To tackle this challenge, we implemented innovative measures to augment our dataset. Recording videos enabled us to capture dynamic UAV images in flight, 
      expanding the range of perspectives and scenarios for more diverse training data. Additionally, we incorporated a jitter to simulate visual instability encountered in actual
      flights, enhancing the realism of our training data.</p>

    <img src="https://github.com/mengze3/mengze3.github.io/blob/629a88ce29542fd2cee39b2c2a2153936f48cf86/_pages/new_detect.png?raw=true" alt="improved detection">
    <table border="1">
    <tr>
      <th style="text-align: center;"></th>
      <th style="text-align: center;">original detection</th>
      <th style="text-align: center;">improved detection</th>
    </tr>
    <tr>
      <td style="text-align: center;">Precision(%)</td>
      <td style="text-align: center;">63</td>
      <td style="text-align: center;">98</td>
    </tr>
    <tr>
      <td style="text-align: center;">Recall(%)</td>
     <td style="text-align: center;">36</td>
      <td style="text-align: center;">97</td>
    </tr>
  </table>
    <p>    Through persistent efforts and optimization, our image recognition accuracy experienced a substantial boost, with recall rates increasing from 36% to 97% and precision surging from 68% to 98%.
      This remarkable improvement has significantly bolstered the robustness of our robot tracking. Particularly noteworthy is that when the confidence (threshold) is set at 0.5, 
      the system demonstrates exceptionally high reliability and efficiency.</p>


    <img src="https://github.com/mengze3/mengze3.github.io/blob/2a12037a0b6628c7cc9cf14e5cf4312e5e556653/_pages/yolo.png?raw=true" alt="improved detection">
    <p>The left side of the image shows examples of objects identified by the trained model, while the right side displays charts of various training metrics. 
      These charts include changes in the loss function, as well as variations in evaluation metrics such as precision, recall, and mean Average Precision (mAP).</p>
    <p>Loss Function: The train/box_loss, train/obj_loss, train/cls_loss, and corresponding validation set losses val/box_loss, val/obj_loss, 
      val/cls_loss all show a gradual decrease with increasing training epochs, indicating that the model is progressively improving, learning to better identify and classify objects.</p>
    <p>Precision and Recall: The metrics/precision and metrics/recall charts show that both these metrics are high, close to 1.0, 
      indicating that the model can correctly identify most true positives and rarely misclassifies negatives as positives.</p>
    <p>Mean Average Precision (mAP): The metrics/mAP_0.5 and metrics/mAP_0.5:0.95 represent the mAP at IoU (Intersection over Union) thresholds of 0.5 and between 0.5 to 0.95, respectively. 
      Both of these metrics also exhibit high values, especially the metrics/mAP_0.5 is near perfect, signifying that the model performs well across different IoU thresholds</p>
  
</body>
